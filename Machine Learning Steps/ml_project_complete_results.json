{
  "metadata": {
    "version": "2.0",
    "created": "2025-12-07 13:46:19",
    "pipeline_type": "End-to-End ML Pipeline with Interpretations",
    "domain": "Healthcare - Heart Disease Prediction",
    "notebook": "complete_ml_pipeline.ipynb"
  },
  "project": {
    "title": "Complete ML Pipeline - Heart Disease Prediction",
    "description": "End-to-end machine learning pipeline with data cleaning, EDA, feature engineering, SMOTE balancing, clustering, and precision-focused model optimization",
    "date": "2025-12-07 13:46:19",
    "goal": "Achieve precision ≥ 0.9 for heart disease prediction",
    "dataset": {
      "name": "Heart Disease Dataset",
      "original_samples": 294,
      "features": 10,
      "target": "Heart Disease (num)",
      "class_distribution": {
        "class_0": 188,
        "class_1": 106
      },
      "imbalance_ratio": 0.5638297872340425,
      "train_test_split": {
        "train": 300,
        "test": 76,
        "ratio": "80/20 stratified"
      }
    }
  },
  "pipeline_flow": {
    "description": "Complete workflow from raw data to production-ready model",
    "stages": [
      {
        "stage": 1,
        "name": "Data Loading & Initial Inspection",
        "steps": [
          "Load CSV",
          "Normalize column names",
          "Initial shape inspection"
        ]
      },
      {
        "stage": 2,
        "name": "Data Cleaning",
        "steps": [
          "Handle missing values",
          "Type coercion",
          "Remove high-missing columns",
          "Drop constants"
        ]
      },
      {
        "stage": 3,
        "name": "Exploratory Data Analysis (EDA)",
        "steps": [
          "Target distribution analysis with interpretation",
          "Feature distribution analysis with skewness detection",
          "Correlation analysis with multicollinearity check",
          "Outlier detection with IQR method",
          "Data cleaning based on insights"
        ]
      },
      {
        "stage": 4,
        "name": "Feature Engineering",
        "steps": [
          "StandardScaler normalization",
          "Feature selection (correlation threshold)",
          "Missing value imputation"
        ]
      },
      {
        "stage": 5,
        "name": "Class Balancing",
        "steps": [
          "SMOTE application",
          "Balance verification"
        ]
      },
      {
        "stage": 6,
        "name": "Unsupervised Learning",
        "steps": [
          "K-Means clustering",
          "Optimal k selection",
          "PCA visualization",
          "Cluster interpretation"
        ]
      },
      {
        "stage": 7,
        "name": "Model Training",
        "steps": [
          "Train/test split",
          "Multi-model baseline",
          "Hyperparameter tuning",
          "Model comparison"
        ]
      },
      {
        "stage": 8,
        "name": "Results Export",
        "steps": [
          "JSON generation",
          "Model persistence",
          "Plot generation"
        ]
      }
    ]
  },
  "data_preparation": {
    "steps": [
      {
        "step": 1,
        "title": "Data Loading",
        "description": "Load heart disease dataset from CSV (latin1 encoding)",
        "input": "data.csv",
        "output": "294 rows × 11 columns"
      },
      {
        "step": 2,
        "title": "Column Normalization",
        "description": "Strip whitespace from column names for consistency",
        "changes": "Column names cleaned"
      },
      {
        "step": 3,
        "title": "Missing Value Handling",
        "description": "Normalize missing tokens (?,-,NA,N/A,none,null,nan) to NaN",
        "missing_tokens": [
          "?"
        ]
      },
      {
        "step": 4,
        "title": "Data Type Coercion",
        "description": "Coerce numeric strings (remove commas/percent signs), parse dates, convert booleans",
        "methods": [
          "numeric coercion",
          "datetime parsing",
          "boolean conversion"
        ]
      },
      {
        "step": 5,
        "title": "Column Dropping",
        "description": "Drop columns with >90% missing and constant columns",
        "dropped_columns": [
          "None"
        ],
        "reason": ">90% missing values or constant"
      },
      {
        "step": 6,
        "title": "Duplicate Removal",
        "description": "Remove 0 duplicate rows",
        "removed": 0
      },
      {
        "step": 7,
        "title": "Target Validation",
        "description": "Ensure target column present, coerce to integer, drop rows with missing target",
        "output": "cleaned_data.csv (294 rows × 11 columns)"
      }
    ],
    "missing_percentages": {
      "ca": 98.98,
      "thal": 90.48,
      "slope": 64.63,
      "chol": 7.82,
      "fbs": 2.72,
      "trestbps": 0.34,
      "thalach": 0.34,
      "exang": 0.34,
      "restecg": 0.34,
      "age": 0.0
    },
    "features_after_cleaning": [
      "age",
      "sex",
      "cp",
      "trestbps",
      "chol",
      "fbs",
      "thalach",
      "exang",
      "oldpeak",
      "slope"
    ]
  },
  "exploratory_data_analysis": {
    "target_analysis": {
      "title": "Target Distribution Analysis",
      "plot": "plot_target_distribution.png",
      "class_distribution": {
        "class_0": {
          "count": 188,
          "percentage": 63.94557823129252
        },
        "class_1": {
          "count": 106,
          "percentage": 36.054421768707485
        }
      },
      "imbalance_ratio": 0.5638297872340425,
      "interpretation": {
        "severity": "moderate",
        "issue": "Class imbalance detected - minority class underrepresented",
        "impact": "Can lead to biased models favoring majority class",
        "solution": "SMOTE applied in Step 8 to balance classes"
      },
      "recommendations": [
        "Apply SMOTE (Synthetic Minority Over-sampling)",
        "Use stratified train-test split",
        "Consider precision/recall metrics instead of accuracy",
        "Use class weights if needed"
      ]
    },
    "feature_distribution_analysis": {
      "title": "Feature Distribution Analysis",
      "plot": "plot_numeric_histograms.png",
      "total_features": 10,
      "skewness_analysis": {
        "highly_skewed": [
          {
            "feature": "fbs",
            "skewness": 3.3905206787422375,
            "direction": "right"
          },
          {
            "feature": "restecg",
            "skewness": 1.983401889114331,
            "direction": "right"
          },
          {
            "feature": "slope",
            "skewness": -1.8095176452730561,
            "direction": "left"
          },
          {
            "feature": "oldpeak",
            "skewness": 1.5488244196598286,
            "direction": "right"
          },
          {
            "feature": "chol",
            "skewness": 1.4333860428220793,
            "direction": "right"
          },
          {
            "feature": "sex",
            "skewness": -1.010104356017189,
            "direction": "left"
          }
        ],
        "moderately_skewed": [
          {
            "feature": "exang",
            "skewness": 0.8578670756732999,
            "direction": "right"
          },
          {
            "feature": "trestbps",
            "skewness": 0.7382701998622878,
            "direction": "right"
          }
        ]
      },
      "interpretation": {
        "issue": "Several features show high skewness",
        "impact": "Skewed distributions can affect linear model performance",
        "solution": "StandardScaler applied in Step 5, tree-based models are robust to skewness"
      },
      "recommendations": [
        "Log transformation for highly right-skewed features (optional)",
        "StandardScaler normalizes distributions",
        "Tree-based models handle skewness well"
      ]
    },
    "correlation_analysis": {
      "title": "Correlation Analysis",
      "plot": "plot_correlation_heatmap.png",
      "correlation_with_target": {
        "strong_features": [
          "exang",
          "oldpeak",
          "slope",
          "cp"
        ],
        "strong_count": 4,
        "moderate_features": [
          "thalach"
        ],
        "moderate_count": 1,
        "weak_features": [
          "sex",
          "chol",
          "fbs",
          "age",
          "trestbps",
          "restecg"
        ],
        "weak_count": 6
      },
      "multicollinearity": {
        "severe_pairs": [],
        "status": "No severe multicollinearity detected (all pairs < 0.9)"
      },
      "very_weak_features": [
        "restecg"
      ],
      "interpretation": {
        "strong_predictors": "4 features with strong correlation (>0.5)",
        "action_taken": "Removed 1 feature(s) with correlation <0.05",
        "multicollinearity_status": "Clean - no redundant feature pairs"
      },
      "recommendations": [
        "Keep strongly correlated features (primary predictors)",
        "Remove very weak features to reduce noise",
        "Monitor for multicollinearity in Step 6"
      ]
    },
    "outlier_analysis": {
      "title": "Outlier Detection Analysis",
      "plot": "plot_boxplots.png",
      "method": "IQR (Interquartile Range)",
      "features_with_outliers": [
        {
          "feature": "fbs",
          "outlier_count": 20,
          "outlier_percentage": 6.802721088435375,
          "severity": "moderate"
        },
        {
          "feature": "slope",
          "outlier_count": 13,
          "outlier_percentage": 4.421768707482993,
          "severity": "minor"
        },
        {
          "feature": "chol",
          "outlier_count": 11,
          "outlier_percentage": 3.741496598639456,
          "severity": "minor"
        },
        {
          "feature": "oldpeak",
          "outlier_count": 11,
          "outlier_percentage": 3.741496598639456,
          "severity": "minor"
        },
        {
          "feature": "trestbps",
          "outlier_count": 8,
          "outlier_percentage": 2.7210884353741496,
          "severity": "minor"
        }
      ],
      "interpretation": {
        "total_features_with_outliers": 5,
        "decision": "Keep outliers - likely clinically significant in medical data",
        "reasoning": [
          "Medical data often has legitimate extreme values",
          "Outliers may be clinically important",
          "Tree-based models are robust to outliers",
          "StandardScaler reduces outlier impact"
        ]
      },
      "recommendations": [
        "Keep outliers for medical data integrity",
        "Consider Winsorization if model performance is poor",
        "Use robust scaling methods as alternative",
        "Verify data quality if needed"
      ]
    },
    "data_cleaning_actions": {
      "features_removed": [
        "restecg"
      ],
      "reason": "Very weak correlation with target (<0.05)",
      "shape_before_cleaning": [
        294,
        12
      ],
      "shape_after_cleaning": [
        294,
        11
      ],
      "summary": "Removed 1 feature(s) based on correlation analysis"
    }
  },
  "feature_engineering": {
    "steps": [
      {
        "title": "Feature Scaling",
        "description": "StandardScaler normalization (mean=0, std=1)",
        "method": "StandardScaler"
      },
      {
        "title": "Feature Selection",
        "description": "Remove highly correlated features (threshold=0.95)",
        "removed_features": [
          "None"
        ],
        "features_remaining": 10
      },
      {
        "title": "Missing Value Imputation",
        "description": "Median imputation for remaining missing values",
        "method": "SimpleImputer(strategy='median')"
      }
    ]
  },
  "class_balancing": {
    "method": "SMOTE",
    "description": "Synthetic Minority Over-sampling Technique",
    "before": {
      "class_0": 188,
      "class_1": 106
    },
    "after": {
      "class_0": 188,
      "class_1": 188
    },
    "samples_added": 82,
    "plot": "plot_smote_balancing.png"
  },
  "unsupervised_learning": {
    "title": "Unsupervised Learning - Pattern Discovery",
    "description": "K-Means clustering and PCA dimensionality reduction to discover natural patterns in patient data",
    "clustering": {
      "method": "K-Means",
      "data_used": "Original scaled data (before SMOTE)",
      "samples_clustered": 294,
      "features_used": 10,
      "optimization": {
        "method": "Elbow Method + Silhouette Score",
        "k_range_tested": [
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10
        ],
        "silhouette_scores": [
          0.23912711712070078,
          0.15043821795231638,
          0.2111866219604474,
          0.18819512663129534,
          0.19876385786564232,
          0.18122228135348784,
          0.17651081425975793,
          0.17854725140471156,
          0.18494001466024448
        ]
      },
      "optimal_k": 2,
      "final_silhouette_score": 0.23912711712070078,
      "cluster_distribution": {
        "cluster_0": {
          "count": 97,
          "percentage": 32.99319727891156
        },
        "cluster_1": {
          "count": 197,
          "percentage": 67.00680272108843
        }
      },
      "interpretation": {
        "quality": "Poor",
        "meaning": "Identified 2 distinct patient groups with similar characteristics",
        "clinical_relevance": "Clusters may represent different disease severity levels or patient profiles"
      },
      "plots": [
        "plot_clustering_metrics.png",
        "plot_clustering_pca.png"
      ]
    },
    "dimensionality_reduction": {
      "method": "PCA (Principal Component Analysis)",
      "purpose": "2D visualization of high-dimensional feature space",
      "components": 2,
      "explained_variance_pc1": 0.29176095929724866,
      "explained_variance_pc2": 0.12825203026883766,
      "total_explained_variance": 0.42001298956608635,
      "interpretation": {
        "variance_captured": "42.0% of variance captured in 2D",
        "meaning": "2 principal components summarize the most important patterns in the data",
        "visualization": "Enables visual inspection of cluster separation and data structure"
      }
    },
    "insights": {
      "key_findings": [
        "Discovered 2 natural groupings in patient data",
        "Silhouette score of 0.239 indicates reasonable cluster quality",
        "Clusters may represent different risk profiles or disease stages",
        "PCA visualization confirms cluster separation"
      ],
      "applications": [
        "Patient stratification for personalized treatment",
        "Risk group identification",
        "Feature importance validation",
        "Anomaly detection"
      ]
    }
  },
  "model_training": {
    "initial_models": {
      "description": "Baseline model comparison",
      "models_trained": [
        "LogisticRegression",
        "RandomForest",
        "GradientBoosting",
        "ExtraTrees",
        "AdaBoost"
      ],
      "results_file": "model_comparison_initial.csv",
      "plot": "plot_roc_curves_initial.png"
    },
    "hyperparameter_tuning": {
      "description": "Aggressive precision-focused RandomizedSearchCV",
      "objective": "Maximize precision (target ≥ 0.9)",
      "method": "RandomizedSearchCV",
      "cross_validation": "StratifiedKFold (5 folds)",
      "iterations_per_model": 80,
      "scoring": "precision",
      "results_file": "all_models_precision_comparison.csv"
    }
  },
  "model_comparison": {
    "description": "Comparison of all tuned models",
    "models": [
      {
        "model": "ExtraTrees",
        "accuracy": 0.8552631578947368,
        "precision": 0.9090909090909092,
        "recall": 0.7894736842105263,
        "f1": 0.8450704225352113,
        "roc_auc": 0.9445983379501386
      },
      {
        "model": "RandomForest",
        "accuracy": 0.8552631578947368,
        "precision": 0.8857142857142857,
        "recall": 0.8157894736842105,
        "f1": 0.8493150684931506,
        "roc_auc": 0.9078947368421052
      },
      {
        "model": "GradientBoosting",
        "accuracy": 0.8289473684210527,
        "precision": 0.8571428571428571,
        "recall": 0.7894736842105263,
        "f1": 0.821917808219178,
        "roc_auc": 0.8559556786703602
      },
      {
        "model": "LogisticRegression",
        "accuracy": 0.8157894736842105,
        "precision": 0.8529411764705882,
        "recall": 0.7631578947368421,
        "f1": 0.8055555555555556,
        "roc_auc": 0.8801939058171745
      },
      {
        "model": "AdaBoost",
        "accuracy": 0.8157894736842105,
        "precision": 0.8333333333333334,
        "recall": 0.7894736842105263,
        "f1": 0.8108108108108109,
        "roc_auc": 0.8698060941828255
      }
    ],
    "best_model": {
      "name": "ExtraTrees",
      "accuracy": 0.8552631578947368,
      "precision": 0.9090909090909092,
      "recall": 0.7894736842105263,
      "f1": 0.8450704225352113,
      "roc_auc": 0.9445983379501386
    },
    "target_met": true,
    "precision_target": 0.9,
    "plot": "model_comparison_final.png"
  },
  "analysis_insights_summary": {
    "key_findings": {
      "data_quality": {
        "status": "Good after cleaning",
        "missing_values_handled": true,
        "features_removed": 1,
        "reason_for_removal": "Very weak correlation with target (<0.05)"
      },
      "class_imbalance": {
        "detected": true,
        "severity": "Moderate",
        "imbalance_ratio": 0.5638297872340425,
        "solution": "SMOTE balancing applied",
        "result": "Classes fully balanced"
      },
      "feature_quality": {
        "strong_predictors": 4,
        "moderate_predictors": 1,
        "weak_predictors": 6,
        "highly_skewed_features": 6,
        "multicollinearity": "None detected"
      },
      "outliers": {
        "features_affected": 5,
        "decision": "Kept - clinically significant",
        "justification": "Medical data outliers often represent important clinical cases"
      },
      "patterns_discovered": {
        "patient_groups": 2,
        "cluster_quality": "Silhouette score: 0.239",
        "interpretation": "Natural patient stratification identified"
      }
    },
    "recommendations_implemented": [
      "Applied SMOTE to balance classes",
      "Removed weak features to reduce noise",
      "Kept outliers due to clinical significance",
      "Used StandardScaler to handle skewness",
      "Applied correlation-based feature selection",
      "Used stratified split to maintain class proportions"
    ],
    "model_performance": {
      "best_model": "ExtraTrees",
      "precision_achieved": 0.9090909090909092,
      "precision_target": 0.9,
      "target_met": true,
      "all_models_compared": 5
    }
  },
  "recommendations": {
    "production_model": "ExtraTrees",
    "reason": "Best precision (0.9091) among all tuned models",
    "next_steps": [
      "Deploy best model for production use",
      "Monitor model performance on new data",
      "Consider threshold tuning if precision ≥ 0.9 is strictly required",
      "Implement model retraining pipeline"
    ],
    "model_files": {
      "LogisticRegression": "model_tuned_LogisticRegression.joblib",
      "RandomForest": "model_tuned_RandomForest.joblib",
      "GradientBoosting": "model_tuned_GradientBoosting.joblib",
      "ExtraTrees": "model_tuned_ExtraTrees.joblib",
      "AdaBoost": "model_tuned_AdaBoost.joblib"
    }
  },
  "files_generated": {
    "cleaned_data": "cleaned_data.csv",
    "model_comparisons": [
      "model_comparison_initial.csv",
      "all_models_precision_comparison.csv"
    ],
    "model_artifacts": [
      "model_tuned_LogisticRegression.joblib",
      "model_tuned_RandomForest.joblib",
      "model_tuned_GradientBoosting.joblib",
      "model_tuned_ExtraTrees.joblib",
      "model_tuned_AdaBoost.joblib"
    ],
    "plots": [
      "plot_missing_values.png",
      "plot_target_distribution.png",
      "plot_numeric_histograms.png",
      "plot_correlation_heatmap.png",
      "plot_boxplots.png",
      "plot_smote_balancing.png",
      "plot_clustering_metrics.png",
      "plot_clustering_pca.png",
      "plot_roc_curves_initial.png",
      "model_comparison_final.png"
    ]
  }
}